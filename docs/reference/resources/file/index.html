<!DOCTYPE html><html><head><meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible" /><meta charset="utf-8" /><meta content="width=device-width,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no" name="viewport" /><link href="/favicon.png" rel="icon" type="image/png" /><link href="/favicon.ico" rel="icon" /><title>About the file Resource</title><meta name="description" /><link href="/css/inspec_tutorial.css" rel="stylesheet" type="text/css" /><link href="/stylesheets/vendor/fontawesome.min.css" rel="stylesheet" type="text/css" /><link href="/stylesheets/site.css" rel="stylesheet" /></head><body class="docs docs_reference docs_reference_resources docs_reference_resources_file docs_reference_resources_file_index"><script>gm_session_id = 'inspecGlobalMessage8';</script><div class="container"><nav class="shadow" id="main-nav"><progress value="0"></progress><div id="main-nav-ctas"><a class="main-nav--logo" href="/"><img alt="logo for Chef InSpec" onerror="this.src='/images/chef-inspec.png'" src="/images/chef-inspec.svg" /></a><i class="fa fa-bars main-nav--toggle strict-right mobile-show"></i><ul class="main-nav--links"><li class="main-nav--link"><a href="/tutorials" class="link " <span class="main-nav--link-text">Tutorials</span></a></li><li class="main-nav--link"><a href="/docs" class="link " <span class="main-nav--link-text">Docs</span></a></li><li class="main-nav--link"><a href="/community" class="link " <span class="main-nav--link-text">Community</span></a></li><li class="main-nav--link"><a class="link" href="https://github.com/chef/inspec"><i class="fa fa-github"></i><span class="main-nav--link-text">Github</span></a></li><li class="nav-cta"><a class="button btn-sm btn-purple" href="/docs/reference/install"><i class="fa fa-cloud-download"></i>Download</a></li></ul></div></nav><main id="main-content"><!--header search--><header class="bg-gradient margin-top-offset relative"><div class="row"><div class="columns large-12 medium-12 z-20"><div class="flex align margin-both"><form action="/docs/search/" class="main-sidebar--search shadow-dark" method="get"><input class="st-default-search-input" name="q" placeholder="Search documentation..." type="search" /></form></div></div></div><div id="particles-second"><canvas class="particles-js-canvas-el" /></div></header><div class="row margin-both relative"><column class="columns large-3 medium-3 mobile-hide" id="sidebar"><ul class="main-sidebar--links"><li class="main-sidebar--link"><small>Getting Started</small><ul class="main-sidebar--list no-bullet"><li class="main-sidebar--list--item--a"><a href="/docs">Overview</a><i class="fa fa-angle-double-right focus strict-right"></i></li><li class="main-sidebar--list--item--a"><a href="/docs/reference/install">Install and Uninstall</a><i class="fa fa-angle-double-right focus strict-right"></i></li><li class="main-sidebar--list--item--a"><a href="/docs/reference/platforms">Chef InSpec for the cloud</a><i class="fa fa-angle-double-right focus strict-right"></i></li><li class="main-sidebar--list--item--a"><a href="/tutorials">Tutorials</a><i class="fa fa-angle-double-right focus strict-right"></i></li><li class="main-sidebar--list--item--a"><a href="/docs/reference/inspec_and_friends">Chef InSpec and friends</a><i class="fa fa-angle-double-right focus strict-right"></i></li><li class="main-sidebar--list--item--a"><a href="/docs/reference/glossary">Chef InSpec Glossary</a><i class="fa fa-angle-double-right focus strict-right"></i></li></ul></li><li class="main-sidebar--link"><small>Reference</small><ul class="main-sidebar--list no-bullet"><li class="main-sidebar--list--item--a"><a href="/docs/reference/cli">inspec executable</a><i class="fa fa-angle-double-right focus strict-right"></i></li><li class="main-sidebar--list--item--a"><a href="/docs/reference/profiles">Profiles</a><i class="fa fa-angle-double-right focus strict-right"></i></li><li class="main-sidebar--list--item--a"><a href="/docs/reference/resources">Resources</a><i class="fa fa-angle-double-right focus strict-right"></i></li><li class="main-sidebar--list--item--a"><a href="/docs/reference/inputs">Inputs</a><i class="fa fa-angle-double-right focus strict-right"></i></li><li class="main-sidebar--list--item--a"><a href="/docs/reference/matchers">Matchers</a><i class="fa fa-angle-double-right focus strict-right"></i></li><li class="main-sidebar--list--item--a"><a href="/docs/reference/reporters">Reporters</a><i class="fa fa-angle-double-right focus strict-right"></i></li><li class="main-sidebar--list--item--a"><a href="/docs/reference/config">Configuration</a><i class="fa fa-angle-double-right focus strict-right"></i></li><li class="main-sidebar--list--item--a"><a href="/docs/reference/dsl_inspec">Chef InSpec DSL</a><i class="fa fa-angle-double-right focus strict-right"></i></li><li class="main-sidebar--list--item--a"><a href="/docs/reference/style">Profile Style guide</a><i class="fa fa-angle-double-right focus strict-right"></i></li><li class="main-sidebar--list--item--a"><a href="/docs/reference/dsl_resource">Custom Resources</a><i class="fa fa-angle-double-right focus strict-right"></i></li><li class="main-sidebar--list--item--a"><a href="/docs/reference/plugins">Plugins</a><i class="fa fa-angle-double-right focus strict-right"></i></li><li class="main-sidebar--list--item--a"><a href="/docs/reference/plugin_kitchen_inspec">kitchen-inspec</a><i class="fa fa-angle-double-right focus strict-right"></i></li><li class="main-sidebar--list--item--a"><a href="/docs/reference/shell">inspec shell</a><i class="fa fa-angle-double-right focus strict-right"></i></li><li class="main-sidebar--list--item--a"><a href="/docs/reference/habitat">Chef Habitat Integration</a><i class="fa fa-angle-double-right focus strict-right"></i></li><li class="main-sidebar--list--item--a"><a href="/docs/reference/migration">Migration from Serverspec</a><i class="fa fa-angle-double-right focus strict-right"></i></li><li class="main-sidebar--list--item--a"><a href="/docs/reference/waivers">Waivers</a><i class="fa fa-angle-double-right focus strict-right"></i></li></ul></li></ul></column><column class="columns large-9 medium-9 mobile-12" id="mainbar"><h1 id="file">file</h1>

<p>Use the <code>file</code> Chef InSpec audit resource to test all system file types, including files, directories, symbolic links, named pipes, sockets, character devices, block devices, and doors.</p>

<p><br></p>

<h2 id="availability">Availability</h2>

<h3 id="installation">Installation</h3>

<p>This resource is distributed along with Chef InSpec itself. You can use it automatically.</p>

<h3 id="version">Version</h3>

<p>This resource first became available in v1.0.0 of InSpec.</p>

<h2 id="syntax">Syntax</h2>

<p>A <code>file</code> resource block declares the location of the file type to be tested, the expected file type  (if required), and one (or more) resource properties.</p>
<div class="highlight"><pre class="highlight plaintext"><code>describe file('path') do
  it { should PROPERTY 'value' }
end
</code></pre></div>
<p>where</p>

<ul>
<li><code>(&#39;path&#39;)</code> is the name of the file and/or the path to the file.</li>
<li><code>PROPERTY</code> is a valid resource property for this resource&rsquo;</li>
<li><code>&#39;value&#39;</code> is the value to be tested.</li>
</ul>

<p><br></p>

<h2 id="properties">Properties</h2>

<h3 id="general-properties">General Properties</h3>

<p>content, size, basename, path, owner, group, type</p>

<h3 id="unix-linux-properties">Unix/Linux Properties</h3>

<p>symlink, mode, link_path, shallow_link_path, mtime, size, selinux_label, md5sum, sha256sum, path, source, source_path, uid, gid</p>

<h3 id="windows-properties">Windows Properties</h3>

<p>file_version, product_version</p>

<p><br></p>

<h2 id="resource-property-examples">Resource Property Examples</h2>

<h3 id="content">content</h3>

<p>The <code>content</code> property tests if contents in the file match the value specified in a regular expression. The values of the <code>content</code> property are arbitrary and depend on the file type being tested and also the type of information that is expected to be in that file:</p>
<div class="highlight"><pre class="highlight plaintext"><code>its('content') { should match REGEX }
</code></pre></div>
<p>The following complete example tests the <code>pg_hba.conf</code> file in PostgreSQL for MD5 requirements.  The tests look at all <code>host</code> and <code>local</code> settings in that file, and then compare the MD5 checksums against the values in the test:</p>
<div class="highlight"><pre class="highlight plaintext"><code>describe file('/etc/postgresql/9.1/main/pg_hba.conf') do
  its('content') { should match(%r{local\s.*?all\s.*?all\s.*?md5}) }
  its('content') { should match(%r{host\s.*?all\s.*?all\s.*?127.0.0.1\/32\s.*?md5}) }
  its('content') { should match(%r{host\s.*?all\s.*?all\s.*?::1\/128\s.*?md5}) }
end
</code></pre></div>
<h3 id="file_version">file_version</h3>

<p>The <code>file_version</code> property tests if a Windows file&rsquo;s version matches the specified value. The difference between a file&rsquo;s &ldquo;file version&rdquo; and &ldquo;product version&rdquo; is that the file version is the version number of the file itself, whereas the product version is the version number associated with the application from which that file originates:</p>
<div class="highlight"><pre class="highlight plaintext"><code>its('file_version') { should eq '1.2.3' }
</code></pre></div>
<h3 id="group">group</h3>

<p>The <code>group</code> property tests if the group to which a file belongs matches the specified value.</p>
<div class="highlight"><pre class="highlight plaintext"><code>its('group') { should eq 'admins' }
</code></pre></div>
<p>The following examples show how to use this Chef InSpec audit resource.</p>

<h3 id="link_path">link_path</h3>

<p>The <code>link_path</code> property tests if the file exists at the specified path. If the file is a symlink,
Chef InSpec will resolve the symlink recursively and return the ultimate linked file.</p>
<div class="highlight"><pre class="highlight plaintext"><code>its('link_path') { should eq '/some/path/to/file' }
</code></pre></div>
<h3 id="shallow_link_path">shallow_link_path</h3>

<p>The <code>shallow_link_path</code>` property returns the path that the file refers to, only resolving
it once (that is, it performs a readlink operation). If the file is not a symlink, nil is returned.</p>
<div class="highlight"><pre class="highlight plaintext"><code>its('shallow_link_path') { should eq '/some/path/to/file' }
</code></pre></div>
<h3 id="md5sum">md5sum</h3>

<p>The <code>md5sum</code> property tests if the MD5 checksum for a file matches the specified value.</p>
<div class="highlight"><pre class="highlight plaintext"><code>its('md5sum') { should eq '3329x3hf9130gjs9jlasf2305mx91s4j' }
</code></pre></div>
<h3 id="mode">mode</h3>

<p>The <code>mode</code> property tests if the mode assigned to the file matches the specified value.</p>
<div class="highlight"><pre class="highlight plaintext"><code>its('mode') { should cmp '0644' }
</code></pre></div>
<p>Chef InSpec <a href="https://en.wikipedia.org/wiki/Leading_zero#0_as_a_prefix">octal</a> values begin the numeric mode specification with zero.</p>

<p>For example, write:</p>
<div class="highlight"><pre class="highlight plaintext"><code>{ should cmp '0644' }
</code></pre></div>
<p>not</p>
<div class="highlight"><pre class="highlight plaintext"><code>{ should cmp '644' }
</code></pre></div>
<p>or write:</p>
<div class="highlight"><pre class="highlight plaintext"><code>{ should cmp '01775' }
</code></pre></div>
<p>not</p>
<div class="highlight"><pre class="highlight plaintext"><code>{ should cmp '1775' }
</code></pre></div>
<p>Without the zero prefix for the octal value, Chef InSpec will interpret it as the <em>decimal</em> value 644, which is octal 1024 or <code>-----w-r-T</code>, and any test for a file that is <code>-rw-r--r--</code> will fail.</p>

<p>Note: see the <a href="#be_more_permissive_than?(mode)"><code>be_more_permissive_than(mode)</code></a> matcher for upper and lower bounds on file mode.</p>

<h3 id="mtime">mtime</h3>

<p>The <code>mtime</code> property tests if the file modification time for the file matches the specified value. The mtime, where supported, is returned as the number of seconds since the epoch.</p>
<div class="highlight"><pre class="highlight plaintext"><code>describe file('/') do
  its('mtime') { should &lt;= Time.now.to_i }
  its('mtime') { should &gt;= Time.now.to_i - 1000 }
end
</code></pre></div>
<h3 id="owner">owner</h3>

<p>The <code>owner</code> property tests if the owner of the file matches the specified value.</p>
<div class="highlight"><pre class="highlight plaintext"><code>its('owner') { should eq 'root' }
</code></pre></div>
<h3 id="product_version">product_version</h3>

<p>The <code>product_version</code> property tests if a Windows file&rsquo;s product version matches the specified value. The difference between a file&rsquo;s &ldquo;file version&rdquo; and &ldquo;product version&rdquo; is that the file version is the version number of the file itself, whereas the product version is the version number associated with the application from which that file originates.</p>
<div class="highlight"><pre class="highlight plaintext"><code>its('product_version') { should eq '2.3.4' }
</code></pre></div>
<h3 id="selinux_label">selinux_label</h3>

<p>The <code>selinux_label</code> property tests if the SELinux label for a file matches the specified value.</p>
<div class="highlight"><pre class="highlight plaintext"><code>its('selinux_label') { should eq 'system_u:system_r:httpd_t:s0' }
</code></pre></div>
<h3 id="sha256sum">sha256sum</h3>

<p>The <code>sha256sum</code> property tests if the SHA-256 checksum for a file matches the specified value.</p>
<div class="highlight"><pre class="highlight plaintext"><code>its('sha256sum') { should eq 'b837ch38lh19bb8eaopl8jvxwd2e4g58jn9lkho1w3ed9jbkeicalplaad9k0pjn' }
</code></pre></div>
<h3 id="size">size</h3>

<p>The <code>size</code> property tests if a file&rsquo;s size matches, is greater than, or is less than the specified value. For example, equal:</p>
<div class="highlight"><pre class="highlight plaintext"><code>its('size') { should eq 32375 }
</code></pre></div>
<p>Greater than:</p>
<div class="highlight"><pre class="highlight plaintext"><code>its('size') { should &gt; 64 }
</code></pre></div>
<p>Less than:</p>
<div class="highlight"><pre class="highlight plaintext"><code>its('size') { should &lt; 10240 }
</code></pre></div>
<h3 id="type">type</h3>

<p>The <code>type</code> property tests for the file type. The available types are:</p>

<ul>
<li><code>file</code>: the object is a file</li>
<li><code>directory</code>: the object is a directory</li>
<li><code>link</code>: the object is a symbolic link</li>
<li><code>pipe</code>: the object is a named pipe</li>
<li><code>socket</code>: the object is a socket</li>
<li><code>character_device</code>: the object is a character device</li>
<li><code>block_device</code>: the object is a block device</li>
<li><code>door</code>: the object is a door device</li>
</ul>

<p>The <code>type</code> method usually returns the type as a Ruby &ldquo;symbol&rdquo;. We recommend using the <code>cmp</code> matcher to match
either by symbol or string.</p>

<p>For example:</p>
<div class="highlight"><pre class="highlight plaintext"><code>its('type') { should eq :file }
its('type') { should cmp 'file' }
</code></pre></div>
<p>or:</p>
<div class="highlight"><pre class="highlight plaintext"><code>its('type') { should eq :socket }
its('type') { should cmp 'socket' }
</code></pre></div>
<h3 id="test-the-contents-of-a-file-for-md5-requirements">Test the contents of a file for MD5 requirements</h3>
<div class="highlight"><pre class="highlight plaintext"><code>describe file('/etc/postgresql/9.1/main/pg_hba.conf') do
  its('content') { should match /local\s.*?all\s.*?all\s.*?md5/ }
  its('content') { should match %r{/host\s.*?all\s.*?all\s.*?127.0.0.1\/32\s.*?md5/} }
  its('content') { should match %r{/host\s.*?all\s.*?all\s.*?::1\/128\s.*?md5/} }
end
</code></pre></div>
<h3 id="test-if-a-file-exists">Test if a file exists</h3>
<div class="highlight"><pre class="highlight plaintext"><code>describe file('/tmp') do
  it { should exist }
end
</code></pre></div>
<h3 id="test-that-a-file-does-not-exist">Test that a file does not exist</h3>
<div class="highlight"><pre class="highlight plaintext"><code>describe file('/tmpest') do
  it { should_not exist }
end
</code></pre></div>
<h3 id="test-if-a-path-is-a-directory">Test if a path is a directory</h3>
<div class="highlight"><pre class="highlight plaintext"><code>describe file('/tmp') do
  its('type') { should eq :directory }
  it { should be_directory }
end
</code></pre></div>
<h3 id="test-if-a-path-is-a-file-and-not-a-directory">Test if a path is a file and not a directory</h3>
<div class="highlight"><pre class="highlight plaintext"><code>describe file('/proc/version') do
  its('type') { should cmp 'file' }
  it { should be_file }
  it { should_not be_directory }
end
</code></pre></div>
<h3 id="test-if-a-file-is-a-symbolic-link">Test if a file is a symbolic link</h3>
<div class="highlight"><pre class="highlight plaintext"><code>describe file('/dev/stdout') do
  its('type') { should cmp 'symlink' }
  it { should be_symlink }
  it { should_not be_file }
  it { should_not be_directory }
end
</code></pre></div>
<h3 id="test-if-a-file-is-a-character-device">Test if a file is a character device</h3>
<div class="highlight"><pre class="highlight plaintext"><code>describe file('/dev/zero') do
  its('type') { should cmp 'character' }
  it { should be_character_device }
  it { should_not be_file }
  it { should_not be_directory }
end
</code></pre></div>
<h3 id="test-if-a-file-is-a-block-device">Test if a file is a block device</h3>
<div class="highlight"><pre class="highlight plaintext"><code>describe file('/dev/zero') do
  its('type') { should cmp 'block' }
  it { should be_character_device }
  it { should_not be_file }
  it { should_not be_directory }
end
</code></pre></div>
<h3 id="test-the-mode-for-a-file">Test the mode for a file</h3>
<div class="highlight"><pre class="highlight plaintext"><code>describe file('/dev') do
 its('mode') { should cmp '00755' }
end
</code></pre></div>
<h3 id="test-the-owner-of-a-file">Test the owner of a file</h3>
<div class="highlight"><pre class="highlight plaintext"><code>describe file('/root') do
  its('owner') { should eq 'root' }
end
</code></pre></div>
<h3 id="test-if-a-file-is-owned-by-the-root-user">Test if a file is owned by the root user</h3>
<div class="highlight"><pre class="highlight plaintext"><code>describe file('/dev') do
  it { should be_owned_by 'root' }
end
</code></pre></div>
<h3 id="test-the-mtime-for-a-file">Test the mtime for a file</h3>
<div class="highlight"><pre class="highlight plaintext"><code>describe file('/') do
  its('mtime') { should &lt;= Time.now.to_i }
  its('mtime') { should &gt;= Time.now.to_i - 1000 }
end
</code></pre></div>
<h3 id="test-that-a-files-size-is-between-64-and-10240">Test that a file&rsquo;s size is between 64 and 10240</h3>
<div class="highlight"><pre class="highlight plaintext"><code>describe file('/') do
  its('size') { should be &gt; 64 }
  its('size') { should be &lt; 10240 }
end
</code></pre></div>
<h3 id="test-that-a-files-size-is-zero">Test that a file&rsquo;s size is zero</h3>
<div class="highlight"><pre class="highlight plaintext"><code>describe file('/proc/cpuinfo') do
  its('size') { should be 0 }
end
</code></pre></div>
<h3 id="test-an-md5-checksum">Test an MD5 checksum</h3>
<div class="highlight"><pre class="highlight plaintext"><code>require 'digest'
cpuinfo = file('/proc/cpuinfo').content

md5sum = Digest::MD5.hexdigest(cpuinfo)

describe file('/proc/cpuinfo') do
  its('md5sum') { should eq md5sum }
end
</code></pre></div>
<h3 id="test-an-sha-256-checksum">Test an SHA-256 checksum</h3>
<div class="highlight"><pre class="highlight plaintext"><code>require 'digest'
cpuinfo = file('/proc/cpuinfo').content

sha256sum = Digest::SHA256.hexdigest(cpuinfo)

describe file('/proc/cpuinfo') do
  its('sha256sum') { should eq sha256sum }
end
</code></pre></div>
<h3 id="verify-ntp">Verify NTP</h3>

<p>The following example shows how to use the <code>file</code> audit resource to verify if the <code>ntp.conf</code> and <code>leap-seconds</code> files are present, and then the <code>command</code> resource to verify if NTP is installed and running:</p>
<div class="highlight"><pre class="highlight plaintext"><code>describe file('/etc/ntp.conf') do
  it { should be_file }
end

describe file('/etc/ntp.leapseconds') do
  it { should be_file }
end

describe command('pgrep ntp') do
  its('exit_status') { should eq 0 }
end
</code></pre></div>
<h3 id="test-parameters-of-symlinked-file">Test parameters of symlinked file</h3>

<p>If you need to test the parameters of the target file for a symlink, you can use the <code>link_path</code> (recursive resolution) or <code>shallow_link_path</code> (direct link) method for the <code>file</code> resource.</p>

<p>For example, for the following symlink:</p>
<div class="highlight"><pre class="highlight plaintext"><code>lrwxrwxrwx. 1 root root 11 03-10 17:56 /dev/virtio-ports/com.redhat.rhevm.vdsm -&gt; ../vport2p1
</code></pre></div>
<p>&hellip; you can write controls for both the link and the target.</p>
<div class="highlight"><pre class="highlight plaintext"><code>describe file('/dev/virtio-ports/com.redhat.rhevm.vdsm') do
  it { should be_symlink }
end

virito_port_vdsm = file('/dev/virtio-ports/com.redhat.rhevm.vdsm').link_path
describe file(virito_port_vdsm) do
  it { should exist }
  it { should be_character_device }
  it { should be_owned_by 'ovirtagent' }
  it { should be_grouped_into 'ovirtagent' }
end
</code></pre></div>
<p><br></p>

<h2 id="matchers">Matchers</h2>

<p>For a full list of available matchers, please visit our <a href="https://www.inspec.io/docs/reference/matchers/">matchers page</a>.</p>

<h3 id="be_allowed">be_allowed</h3>

<p>The <code>be_allowed</code> matcher tests if the file contains a certain permission set, such as <code>execute</code> or <code>write</code> in Unix and <a href="https://www.codeproject.com/Reference/871338/AccessControl-FileSystemRights-Permissions-Table"><code>full-control</code> or <code>modify</code> in Windows</a>.</p>
<div class="highlight"><pre class="highlight plaintext"><code>it { should be_allowed('read') }
</code></pre></div>
<p>Just like with <code>be_executable</code> and other permissions, one can check for the permission with respect to the specific user or group.</p>
<div class="highlight"><pre class="highlight plaintext"><code>it { should be_allowed('full-control', by_user: 'MyComputerName\Administrator') }
</code></pre></div>
<p>OR</p>
<div class="highlight"><pre class="highlight plaintext"><code>it { should be_allowed('write', by: 'root') }
</code></pre></div>
<h3 id="be_block_device">be_block_device</h3>

<p>The <code>be_block_device</code> matcher tests if the file exists as a block device, such as <code>/dev/disk0</code> or <code>/dev/disk0s9</code>:</p>
<div class="highlight"><pre class="highlight plaintext"><code>it { should be_block_device }
</code></pre></div>
<h3 id="be_character_device">be_character_device</h3>

<p>The <code>be_character_device</code> matcher tests if the file exists as a character device (that corresponds to a block device), such as <code>/dev/rdisk0</code> or <code>/dev/rdisk0s9</code>:</p>
<div class="highlight"><pre class="highlight plaintext"><code>it { should be_character_device }
</code></pre></div>
<h3 id="be_directory">be_directory</h3>

<p>The <code>be_directory</code> matcher tests if the file exists as a directory, such as <code>/etc/passwd</code>, <code>/etc/shadow</code>, or <code>/var/log/httpd</code>:</p>
<div class="highlight"><pre class="highlight plaintext"><code>it { should be_directory }
</code></pre></div>
<h3 id="be_executable">be_executable</h3>

<p>The <code>be_executable</code> matcher tests if the file exists as an executable:</p>
<div class="highlight"><pre class="highlight plaintext"><code>it { should be_executable }
</code></pre></div>
<p>The <code>be_executable</code> matcher may also test if the file is executable by a specific owner, group, or user. For example, a group:</p>
<div class="highlight"><pre class="highlight plaintext"><code>it { should be_executable.by('group') }
</code></pre></div>
<p>an owner:</p>
<div class="highlight"><pre class="highlight plaintext"><code>it { should be_executable.by('owner') }
</code></pre></div>
<p>any user other than the owner or members of the file&rsquo;s group:</p>
<div class="highlight"><pre class="highlight plaintext"><code>it { should be_executable.by('others') }
</code></pre></div>
<p>a user:</p>
<div class="highlight"><pre class="highlight plaintext"><code>it { should be_executable.by_user('user') }
</code></pre></div>
<h3 id="be_file">be_file</h3>

<p>The <code>be_file</code> matcher tests if the file exists as a file. This can be useful with configuration files like <code>/etc/passwd</code> where there typically is not an associated file extension&mdash;<code>passwd.txt</code>:</p>
<div class="highlight"><pre class="highlight plaintext"><code>it { should be_file }
</code></pre></div>
<h3 id="be_grouped_into">be_grouped_into</h3>

<p>The <code>be_grouped_into</code> matcher tests if the file exists as part of the named group:</p>
<div class="highlight"><pre class="highlight plaintext"><code>it { should be_grouped_into 'group' }
</code></pre></div>
<h3 id="be_linked_to">be_linked_to</h3>

<p>The <code>be_linked_to</code> matcher tests if the file is linked to the named target:</p>
<div class="highlight"><pre class="highlight plaintext"><code>it { should be_linked_to '/etc/target-file' }
</code></pre></div>
<h3 id="be_owned_by">be_owned_by</h3>

<p>The <code>be_owned_by</code> matcher tests if the file is owned by the named user, such as <code>root</code>:</p>
<div class="highlight"><pre class="highlight plaintext"><code>it { should be_owned_by 'root' }
</code></pre></div>
<h3 id="be_pipe">be_pipe</h3>

<p>The <code>be_pipe</code> matcher tests if the file exists as first-in, first-out special file (<code>.fifo</code>) that is typically used to define a named pipe, such as <code>/var/log/nginx/access.log.fifo</code>:</p>
<div class="highlight"><pre class="highlight plaintext"><code>it { should be_pipe }
</code></pre></div>
<h3 id="be_readable">be_readable</h3>

<p>The <code>be_readable</code> matcher tests if the file is readable:</p>
<div class="highlight"><pre class="highlight plaintext"><code>it { should be_readable }
</code></pre></div>
<p>The <code>be_readable</code> matcher may also test if the file is readable by a specific owner, group, or user. For example, a group:</p>
<div class="highlight"><pre class="highlight plaintext"><code>it { should be_readable.by('group') }
</code></pre></div>
<p>an owner:</p>
<div class="highlight"><pre class="highlight plaintext"><code>it { should be_readable.by('owner') }
</code></pre></div>
<p>any user other than the owner or members of the file&rsquo;s group:</p>
<div class="highlight"><pre class="highlight plaintext"><code>it { should be_readable.by('others') }
</code></pre></div>
<p>a user:</p>
<div class="highlight"><pre class="highlight plaintext"><code>it { should be_readable.by_user('user') }
</code></pre></div>
<h3 id="be_setgid">be_setgid</h3>

<p>The <code>be_setgid</code> matcher tests if the &lsquo;setgid&rsquo; permission is set on the file or directory.  On executable files, this causes the process to be started owned by the group that owns the file, rather than the primary group of the invocating user.  This can result in escalation of privilege.  On Linux, when setgid is set on directories, setgid causes newly created files and directories to be owned by the group that owns the setgid parent directory; additionally, newly created subdirectories will have the setgid bit set.  To use this matcher:</p>
<div class="highlight"><pre class="highlight plaintext"><code>it { should be_setgid }
</code></pre></div>
<h3 id="be_socket">be_socket</h3>

<p>The <code>be_socket</code> matcher tests if the file exists as socket (<code>.sock</code>), such as <code>/var/run/php-fpm.sock</code>:</p>
<div class="highlight"><pre class="highlight plaintext"><code>it { should be_socket }
</code></pre></div>
<h3 id="be_sticky">be_sticky</h3>

<p>The <code>be_sticky</code> matcher tests if the &lsquo;sticky bit&rsquo; permission is set on the directory.  On directories, this restricts file deletion to the owner of the file, even if the permission of the parent directory would normally permit deletion by others.  This is commonly used on /tmp filesystems.  To use this matcher:</p>
<div class="highlight"><pre class="highlight plaintext"><code>it { should be_sticky }
</code></pre></div>
<h3 id="be_setuid">be_setuid</h3>

<p>The <code>be_setuid</code> matcher tests if the &lsquo;setuid&rsquo; permission is set on the file.  On executable files, this causes the process to be started owned by the user that owns the file, rather than invocating user.  This can result in escalation of privilege.  To use this matcher:</p>
<div class="highlight"><pre class="highlight plaintext"><code>it { should be_setuid }
</code></pre></div>
<h3 id="be_symlink">be_symlink</h3>

<p>The <code>be_symlink</code> matcher tests if the file exists as a symbolic, or soft link that contains an absolute or relative path reference to another file:</p>
<div class="highlight"><pre class="highlight plaintext"><code>it { should be_symlink }
</code></pre></div>
<h3 id="be_version">be_version</h3>

<p>The <code>be_version</code> matcher tests the version of the file:</p>
<div class="highlight"><pre class="highlight plaintext"><code>it { should be_version '1.2.3' }
</code></pre></div>
<h3 id="be_writable">be_writable</h3>

<p>The <code>be_writable</code> matcher tests if the file is writable:</p>
<div class="highlight"><pre class="highlight plaintext"><code>it { should be_writable }
</code></pre></div>
<p>The <code>be_writable</code> matcher may also test if the file is writable by a specific owner, group, or user. For example, a group:</p>
<div class="highlight"><pre class="highlight plaintext"><code>it { should be_writable.by('group') }
</code></pre></div>
<p>an owner:</p>
<div class="highlight"><pre class="highlight plaintext"><code>it { should be_writable.by('owner') }
</code></pre></div>
<p>any user other than the owner or members of the file&rsquo;s group:</p>
<div class="highlight"><pre class="highlight plaintext"><code>it { should be_writable.by('others') }
</code></pre></div>
<p>a user:</p>
<div class="highlight"><pre class="highlight plaintext"><code>it { should be_writable.by_user('user') }
</code></pre></div>
<h3 id="exist">exist</h3>

<p>The <code>exist</code> matcher tests if the named file exists:</p>
<div class="highlight"><pre class="highlight plaintext"><code>it { should exist }
</code></pre></div>
<h3 id="have_mode">have_mode</h3>

<p>The <code>have_mode</code> matcher tests if a file has a mode assigned to it:</p>
<div class="highlight"><pre class="highlight plaintext"><code>it { should have_mode }
</code></pre></div>
<h3 id="be_more_permissive_than-mode"><code>be_more_permissive_than(mode)</code></h3>

<p><code>be_more_permissive_than(mode)</code> takes the maximum desired mode - in <code>octal format</code>
(&lsquo;0644&rsquo; or &lsquo;0777&rsquo;) - of your file as a <code>String</code> and returns a <code>Boolean</code>. It will
return <code>true</code> if your file has a mode with greater permissions than specified.</p>
<div class="highlight"><pre class="highlight plaintext"><code>describe file('/etc/passwd') do
  it { should_not be_more_permissive_than('0644') }
  it { should be_more_permissive_than('0000') }
end
</code></pre></div></column><div class="scrollToTop shadow-dark"><img id="scrollup" onerror="this.src='/images/home/arrow.png'" src="/images/home/arrow.svg" /></div></div><script>// Swiftype JS code snippet
(function(w,d,t,u,n,s,e){w['SwiftypeObject']=n;w[n]=w[n]||function(){
(w[n].q=w[n].q||[]).push(arguments);};s=d.createElement(t);
e=d.getElementsByTagName(t)[0];s.async=1;s.src=u;e.parentNode.insertBefore(s,e);
})(window,document,'script','//s.swiftypecdn.com/install/v2/st.js','_st');

_st('install','xzyJV6P7pgscygGyyTm8','2.0.0');
// end Swiftype code snippet

document.getElementsByClassName("st-default-search-input")[0].focus();</script></main></div><footer class="dark-bg" id="main-footer"><div class="strict-center" id="dlmsg"><div class="pad-under-xs"><img alt="image of octagon spinning" id="hex" onerror="this.src='/images/octagon.png'" src="/images/octagon.svg" /></div><h3 class="t-white pad-under-xs">Get started with Chef InSpec and rock on.</h3><div class="row align columns"><div class="strict-center"><a class="button btn-lg btn-purple shadow-dark margin-right-xs mobile-row-btn" href="/downloads"><i class="fa fa-cloud-download"></i><span>download InSpec 4</span></a><a class="button btn-lg btn-white-o shadow-dark mobile-row-btn" href="/tutorials">browse tutorials</a></div></div></div><div class="flex align"><div class="columns large-4 medium-4 mobile-hide"><ul class="footer--logos"><li><a class="footer--logo inspec" href="/"><img alt="logo for Chef InSpec" src="/images/chef-inspec.png" /></a></li><li><a class="footer--logo chef" href="https://www.chef.io"><img alt="logo for Chef Software" src="/images/chef-logo.png" /></a></li></ul></div><div class="columns large-8 medium-8"><ul class="footer--links strict-right"><li><a class="link footer--link" href="https://docs.chef.io/chef_license.html">Licensing</a></li><li><a class="link footer--link" href="https://www.chef.io/terms-of-service/">Terms &amp; Conditions</a></li><li><a class="link footer--link" href="https://www.chef.io/trademark-policy/">Trademark Policy</a></li><li><a class="link footer--link" href="https://www.chef.io/privacy-policy/">Privacy Policy</a></li><li><a class="link footer--link" href="https://www.chef.io/cookie-policy/">Cookie Policy</a></li></ul><div class="columns margin-both-xs mobile-show"><ul class="footer--logos"><li><a class="footer--logo inspec" href="/"><img alt="logo for Chef InSpec" src="/images/chef-inspec.png" /></a></li><li><a class="footer--logo chef" href="http://www.chef.io"><img alt="logo for Chef Software" src="/images/chef-logo.png" /></a></li></ul></div></div></div><p class="strict-center pad-under-xs"><small class="t-gray">&copy; Chef Software 2015-2020</small></p></footer><script src="https://buttons.github.io/buttons.js"></script><script src="/scripts/inspec_tutorial.js"></script><script src="/dist/inspec_tutorial.js"></script><script src="/javascripts/vendor/jquery.min.js"></script><script src="https://s3.amazonaws.com/menumaker/menumaker.min.js"></script><div class="inspec-tutorial" hidden="true" inspec-tutorial="true">Loading</div><script src="/javascripts/all.js"></script><script>function initSlideGroup(group) {
  var prev = -1;
  var links = $(group).find('a')

  links.click(function(e) {
    e.stopPropagation()

    links.removeClass('selected')
    $(this).addClass('selected')

    var idx = $(this).index();
    if(prev == idx) return;
    prev = idx;

    $('.slider .view.slide-in').removeClass('slide-in').addClass('slide-out')
    var el = $('.slider .view')[idx]
    if(el == null) {
      console.log("No element for slider index "+idx)
      return
    }

    $(el).removeClass('slide-out').removeClass('hidden').addClass('slide-in')
  })

  if(links[0] != null) links[0].click();
}

function initSliders() {
  $('.slider .view').addClass('hidden')
  var groups = $('.slider .selectors')
  groups.each(function(idx){
    initSlideGroup(this)
  })
}

//run code colors

$(document).ready(function() {
  initSliders()
  $('pre code').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});

//copy to clipboard

function copyToClipboard(element) {
  var $temp = $("<input>");
  $("body").append($temp);
  $temp.val($(element).text()).select();
  document.execCommand("copy");
  $temp.remove();
}

$('#copy').hover(function() {
   $('#install').toggleClass("text-focus");
});

$('#copy').click(function() {
   $(this).removeClass("fa-copy");
   $(this).addClass("fa-check");

 setTimeout(() => {
   $(this).removeClass('fa-check').addClass('fa-copy');
  }, 1500);
});

// homepage content slider

// tutorial content slider

$(function() {
  $(".collapseContent").hide();
  $(".collapsebtn").addClass("fa-plus-square");

   $('.collapseToggle').click(function() {
      var el = $(this).parent().find('.collapseContent')
      el.slideToggle("fast")
      // $('.collapseContent').slideToggle("fast");
      var btn = $(this).find('.collapsebtn')
      if(btn.hasClass('fa-minus-square')) {
        btn.addClass('fa-plus-square')
        btn.removeClass('fa-minus-square')
      } else {
        btn.addClass('fa-minus-square')
        btn.removeClass('fa-plus-square')
      }
   });
});



// scroll spy animations

var $slide_left = $('.slide-left');
var $slide_right = $('.slide-right');
var $slide_up = $('.slide-up');
var $slide_up_slow = $('.slide-up-slow');
var $window = $(window);

function check_if_in_view() {
  var window_height = $window.height();
  var window_top_position = $window.scrollTop();
  var window_bottom_position = (window_top_position + window_height);

  $.each($slide_left, function() {
    var $element = $(this);
    var element_height = $element.outerHeight();
    var element_top_position = $element.offset().top;
    var element_bottom_position = (element_top_position + element_height);

    //check to see if this current container is within viewport
    if ((element_bottom_position >= window_top_position) &&
        (element_top_position <= window_bottom_position)) {
      $element.addClass('in-view');
    } else {
      $element.removeClass('in-view');
    }
  });

  $.each($slide_right, function() {
    var $element = $(this);
    var element_height = $element.outerHeight();
    var element_top_position = $element.offset().top;
    var element_bottom_position = (element_top_position + element_height);

    //check to see if this current container is within viewport
    if ((element_bottom_position >= window_top_position) &&
        (element_top_position <= window_bottom_position)) {
      $element.addClass('in-view');
    } else {
      $element.removeClass('in-view');
    }
  });

  $.each($slide_up, function() {
    var $element = $(this);
    var element_height = $element.outerHeight();
    var element_top_position = $element.offset().top;
    var element_bottom_position = (element_top_position + element_height);

    //check to see if this current container is within viewport
    if ((element_bottom_position >= window_top_position) &&
        (element_top_position <= window_bottom_position)) {
      $element.addClass('in-view');
    } else {
      $element.removeClass('in-view');
    }
  });

  $.each($slide_up_slow, function() {
    var $element = $(this);
    var element_height = $element.outerHeight();
    var element_top_position = $element.offset().top;
    var element_bottom_position = (element_top_position + element_height);

    //check to see if this current container is within viewport
    if ((element_bottom_position >= window_top_position) &&
        (element_top_position <= window_bottom_position)) {
      $element.addClass('in-view');
    } else {
      $element.removeClass('in-view');
    }
  });
}

$window.on('scroll resize', check_if_in_view);
$window.trigger('scroll');

//scroll to top
$(document).ready(function(){

  $(window).scroll(function(){
    if ($(this).scrollTop() > 100) {
      $('.scrollToTop').fadeIn();
    } else {
      $('.scrollToTop').fadeOut();
    }
  });

  $('.scrollToTop').click(function(){
    $('html, body').animate({scrollTop : 0},800);
    return false;
  });

  // scrolling to resource sections
  $(".resources-button").click(function() {
    var dst = $(this).attr("href")
    $(".resources-button").removeClass("btn-purple").addClass("btn-purple-o")
    $(this).addClass("btn-purple").removeClass("btn-purple-o")
    $("html, body").animate({
        scrollTop: $(dst).offset().top - 105
    }, 1000);
  });

});

//scrolling code box

var div = $('#scrolled');
   setInterval(function(){
    var pos = div.scrollTop();
    div.scrollTop(pos + 2);
}, 200);

//Animating progress bar for header

$(document).ready(function(){

var getMax = function(){
    return $(document).height() - $(window).height();
}

var getValue = function(){
    return $(window).scrollTop();
}

if('max' in document.createElement('progress')){
    // Browser supports progress element
    var progressBar = $('progress');

    // Set the Max attr for the first time
    progressBar.attr({ max: getMax() });

    $(document).on('scroll', function(){
        // On scroll only Value attr needs to be calculated
        progressBar.attr({ value: getValue() });
    });

    $(window).resize(function(){
        // On resize, both Max/Value attr needs to be calculated
        progressBar.attr({ max: getMax(), value: getValue() });
    });
}
else {
    var progressBar = $('.progress-bar'),
        max = getMax(),
        value, width;

    var getWidth = function(){
        // Calculate width in percentage
        value = getValue();
        width = (value/max) * 100;
        width = width + '%';
        return width;
    }

    var setWidth = function(){
        progressBar.css({ width: getWidth() });
    }

    $(document).on('scroll', setWidth);
    $(window).on('resize', function(){
        // Need to reset the Max attr
        max = getMax();
        setWidth();
    });
    }
  });</script><script>$(document).foundation();
$('.try-demo').click(function(event){
  event.stopPropagation();
  $('.inspec-tutorial').show()
  window.dispatchEvent(new Event('resizeTerminal'));
  $('.quit-inspec-tutorial').click(function(event){
    event.stopPropagation();
    $('.inspec-tutorial').hide()
  })
});</script><script src="/javascripts/segment.js"></script></body></html>